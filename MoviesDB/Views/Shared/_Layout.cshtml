<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - My ASP.NET Application</title>
    @*@Styles.Render("~/Content/css")*@
    <link href="~/Content/bootstrap.css" rel="stylesheet" />
    <link href="~/Content/OwlCarousel2-2.3.4-css/owl.carousel.css" rel="stylesheet" />
    <link href="~/Content/magnific-popup.css" rel="stylesheet" />
    <link href="~/Content/select2.min.css" rel="stylesheet" />
    <link href="~/Content/admin.css" rel="stylesheet" />
    @Scripts.Render("~/bundles/modernizr")
    @* <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>*@

<style>


    .mfp-container {
        height: 35% !important;
    }
    a:hover {
        cursor: pointer;
    }
    .header__actions {
        width: 383px!important;
    }
</style>
</head>


<body>


    <!-- header -->
    <header class="header">
        <div class="header__content">
            <!-- header logo -->
            <a href="index.html" class="header__logo">
                <img src="~/Content/images/user.svg" alt="">
            </a>
            <!-- end header logo -->
            <!-- header menu btn -->
            <button class="header__btn" type="button">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <!-- end header menu btn -->
        </div>
    </header>
    <!-- end header -->
    <!-- sidebar -->
    <div class="sidebar">
        <!-- sidebar logo -->
        <a href="@Url.Action("_GetDashboard", "Account")" class="sidebar__logo">
            <img src="img/logo.svg" alt="">
        </a>
        <!-- end sidebar logo -->
        <!-- sidebar user -->
        <div class="sidebar__user">
            <div class="sidebar__user-img">
                <img src="~/Content/images/user.svg" alt="">
            </div>

            <div class="sidebar__user-title">
                <span> @Session["UserRole"]</span>
                <p>@Session["UserName"]</p>
            </div>
            <a href="@Url.Action("Login", "Account")" class="sidebar__user-btn" type="button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,12a1,1,0,0,0,1,1h7.59l-2.3,2.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0l4-4a1,1,0,0,0,.21-.33,1,1,0,0,0,0-.76,1,1,0,0,0-.21-.33l-4-4a1,1,0,1,0-1.42,1.42L12.59,11H5A1,1,0,0,0,4,12ZM17,2H7A3,3,0,0,0,4,5V8A1,1,0,0,0,6,8V5A1,1,0,0,1,7,4H17a1,1,0,0,1,1,1V19a1,1,0,0,1-1,1H7a1,1,0,0,1-1-1V16a1,1,0,0,0-2,0v3a3,3,0,0,0,3,3H17a3,3,0,0,0,3-3V5A3,3,0,0,0,17,2Z" /></svg>
            </a>
        </div>
        <!-- end sidebar user -->
        <!-- sidebar nav -->
        <ul class="sidebar__nav">
            @*<li class="sidebar__nav-item">
                    <a href="index.html" class="sidebar__nav-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,8h0L14,2.74a3,3,0,0,0-4,0L4,8a3,3,0,0,0-1,2.26V19a3,3,0,0,0,3,3H18a3,3,0,0,0,3-3V10.25A3,3,0,0,0,20,8ZM14,20H10V15a1,1,0,0,1,1-1h2a1,1,0,0,1,1,1Zm5-1a1,1,0,0,1-1,1H16V15a3,3,0,0,0-3-3H11a3,3,0,0,0-3,3v5H6a1,1,0,0,1-1-1V10.25a1,1,0,0,1,.34-.75l6-5.25a1,1,0,0,1,1.32,0l6,5.25a1,1,0,0,1,.34.75Z" /></svg> <span>Dashboard</span></a>
                </li>*@
            @*Dashboard*@
            <li class="sidebar__nav-item sidebar__nav-link--active">
                <a id="dashboard" class="sidebar__nav-link dashboard"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,8h0L14,2.74a3,3,0,0,0-4,0L4,8a3,3,0,0,0-1,2.26V19a3,3,0,0,0,3,3H18a3,3,0,0,0,3-3V10.25A3,3,0,0,0,20,8ZM14,20H10V15a1,1,0,0,1,1-1h2a1,1,0,0,1,1,1Zm5-1a1,1,0,0,1-1,1H16V15a3,3,0,0,0-3-3H11a3,3,0,0,0-3,3v5H6a1,1,0,0,1-1-1V10.25a1,1,0,0,1,.34-.75l6-5.25a1,1,0,0,1,1.32,0l6,5.25a1,1,0,0,1,.34.75Z"></path></svg> <span>Dashboard</span></a>
            </li>
            @* Movies List *@
            <li class="sidebar__nav-item">
                <a id="allMoviesButton" class="sidebar__nav-link allMoviesButton">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10,13H3a1,1,0,0,0-1,1v7a1,1,0,0,0,1,1h7a1,1,0,0,0,1-1V14A1,1,0,0,0,10,13ZM9,20H4V15H9ZM21,2H14a1,1,0,0,0-1,1v7a1,1,0,0,0,1,1h7a1,1,0,0,0,1-1V3A1,1,0,0,0,21,2ZM20,9H15V4h5Zm1,4H14a1,1,0,0,0-1,1v7a1,1,0,0,0,1,1h7a1,1,0,0,0,1-1V14A1,1,0,0,0,21,13Zm-1,7H15V15h5ZM10,2H3A1,1,0,0,0,2,3v7a1,1,0,0,0,1,1h7a1,1,0,0,0,1-1V3A1,1,0,0,0,10,2ZM9,9H4V4H9Z" /></svg>
                    <span>Catalog</span>
                </a>
            </li>
            @* Users *@
            <li class="sidebar__nav-item">
                <a id="allUsersButton" class="sidebar__nav-link allUsersButton">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.3,12.22A4.92,4.92,0,0,0,14,8.5a5,5,0,0,0-10,0,4.92,4.92,0,0,0,1.7,3.72A8,8,0,0,0,1,19.5a1,1,0,0,0,2,0,6,6,0,0,1,12,0,1,1,0,0,0,2,0A8,8,0,0,0,12.3,12.22ZM9,11.5a3,3,0,1,1,3-3A3,3,0,0,1,9,11.5Zm9.74.32A5,5,0,0,0,15,3.5a1,1,0,0,0,0,2,3,3,0,0,1,3,3,3,3,0,0,1-1.5,2.59,1,1,0,0,0-.5.84,1,1,0,0,0,.45.86l.39.26.13.07a7,7,0,0,1,4,6.38,1,1,0,0,0,2,0A9,9,0,0,0,18.74,11.82Z" /></svg>
                    <span>Users</span>
                </a>
            </li>


            <li class="sidebar__nav-item">
                <a href="@Url.Action("Index","Movies")" class="sidebar__nav-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17,11H9.41l3.3-3.29a1,1,0,1,0-1.42-1.42l-5,5a1,1,0,0,0-.21.33,1,1,0,0,0,0,.76,1,1,0,0,0,.21.33l5,5a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L9.41,13H17a1,1,0,0,0,0-2Z" /></svg> <span>Back to MoviesDB</span></a>
            </li>
        </ul>
        <!-- end sidebar nav -->
    </div>
    <!-- end sidebar -->
    <div id="content">
        @RenderBody()
    </div>

    <!-- end modal status -->
    <!-- JS -->
    <script src="~/Scripts/jquery.unobtrusive-ajax.js"></script>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)
    @*@Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")*@
    @*@Scripts.Render("~/bundles/magnific-popup")*@
    @*@Styles.Render("~/Content/magnific-popup")*@
    @*@Scripts.Render("~/bundles/jquery")
        @Scripts.Render("~/bundles/bootstrap")*@

    @*@RenderSection("scripts", required: false)*@

    @*@Scripts.Render("~/bundles/jquery")
            @Scripts.Render("~/bundles/bootstrap")
        @Scripts.Render("~/bundles/magnific-popup")
        @Styles.Render("~/Content/magnific-popup")*@
    @*<script src="~/Scripts/jquery-3.5.1.min.js"></script>*@
        <script src="~/Scripts/jquery.magnific-popup.min.js"></script>
        @*<script src="~/Scripts/jquery.unobtrusive-ajax.js"></script>*@

    <script>

        $(document).ready(function() {
            //$('#allMoviesButton').click(function() {
            $('.allMoviesButton').click(function() {
                $.ajax({
                    url: '@Url.Action("_GetAllMovies")',
                    type: 'GET',
                    success: function(result) {
                        $('#content').html(result);
                    },
                    error: function() {
                        // Handle error
                    }
                });
            });
        });

        $(document).ready(function () {
            $('#dashboard').click(function() {
                $.ajax({
                    url: '@Url.Action("_GetDashboard")',
                    type: 'GET',
                    success: function(result) {
                        $('#content').html(result);
                    },
                    error: function() {
                        // Handle error
                    }
                });
            });
        });
        $(document).ready(function() {
            $('.allUsersButton').click(function() {
                $.ajax({
                    url: '@Url.Action("_AllUsers")',
                    type: 'GET',
                    success: function(result) {
                        $('#content').html(result);
                    },
                    error: function() {
                        // Handle error
                    }
                });
            });
        });

    $(document).ready(function () {
    $('.activate-user').click(function (e) {
      console.log("activate")
    // Add the HTML content to the page
      var userId = $(this).data("userid");
      var isActivated = $(this).data("isactivated");
    $('body').prepend(`
      <div class="at mfp-bg my-mfp-zoom-in mfp-ready" id = "popup1"></div>
      <div class="at mfp-wrap mfp-close-btn-in mfp-auto-cursor my-mfp-zoom-in mfp-ready" id = "popup2" tabindex="-1" style="overflow: hidden auto; ">
        <div class="mfp-container mfp-inline-holder">
          <div class="mfp-content">
            <div id="modal-status" class="zoom-anim-dialog modal">
              <h6 class="modal__title">Status change</h6>
              <p class="modal__text">Are you sure you want to immediately change the status?</p>
              <div class="modal__btns">
                <button class="modal__btn modal__btn--apply" type="button">Apply</button>
                <button class="modal__btn modal__btn--dismiss cancel-button" type="button">Dismiss</button>
              </div>
              <button title="Close (Esc)" type="button" class="mfp-close">×</button>
            </div>
          </div>
        </div>
      </div>
    `);

    // Handle the "Apply" button click
      $('.modal__btn--apply').click(function () {
          console.log("apply btn");
          //var userId = $(this).data("userid");
          //var userId = $(this).closest('.mfp-wrap').find('.activate-user').data("userid");
          console.log(userId);
          //var isActivated = $(this).data("isactivated");
          //var isActivated = $(this).closest('.mfp-wrap').find('.activate-user').data("isactivated");
          console.log(isActivated);

          $.ajax({
            url: '@Url.Action("ActivateOrDeactivateUser", "Account")',
            type: 'POST',
            data: { userId: userId, isActivated: isActivated },
            success: function (response) {
              // Refresh the page or perform any other necessary actions
              // alert('User activated successfully!');
              location.reload(); // Refresh the page
            },
            error: function (xhr, status, error) {
              // Handle error response here
              // For example, display an error message
              alert('Error activating user: ' + error);
            }
          });
    });

    // Handle the "Dismiss" button click
    $('.cancel-button').click(function() {
          $('.at').hide();
        });
      });
    });


    $(document).ready(function () {
            $('.sidebar__nav-link').click(function () {
                $('.sidebar__nav-link').removeClass('sidebar__nav-link--active');
                $(this).addClass('sidebar__nav-link--active');
            });
        });


    </script>

</body>
</html>
